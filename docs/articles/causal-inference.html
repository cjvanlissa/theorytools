<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Using FAIR Theory for Causal Inference • theorytools</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<script src="../extra.js"></script><meta property="og:title" content="Using FAIR Theory for Causal Inference">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">theorytools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/causal-inference.html">Using FAIR Theory for Causal Inference</a></li>
    <li><a class="dropdown-item" href="../articles/fair-theory.html">Making a Theory FAIR</a></li>
    <li><a class="dropdown-item" href="../articles/readme.html">What to Include in a README?</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/cjvanlissa/theorytools/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Using FAIR Theory for Causal Inference</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/cjvanlissa/theorytools/blob/HEAD/vignettes/causal-inference.Rmd" class="external-link"><code>vignettes/causal-inference.Rmd</code></a></small>
      <div class="d-none name"><code>causal-inference.Rmd</code></div>
    </div>

    
    
<script>
<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  var t = document.getElementsByClassName("webex-total_correct");
  for (var i = 0; i < t.length; i++) {
    p = t[i].parentElement;
    var correct = p.getElementsByClassName("webex-correct").length;
    var solvemes = p.getElementsByClassName("webex-solveme").length;
    var radiogroups = p.getElementsByClassName("webex-radiogroup").length;
    var selects = p.getElementsByClassName("webex-select").length;

    t[i].innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");

  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* check answers */
check_func = function() {
  console.log("webex: check answers");

  var cl = this.parentElement.classList;
  if (cl.contains('unchecked')) {
    cl.remove("unchecked");
    this.innerHTML = "Hide Answers";
  } else {
    cl.add("unchecked");
    this.innerHTML = "Show Answers";
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");

  var cl = this.classList

  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;

  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }

  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }

  update_total_correct();
}

window.onload = function() {
  console.log("webex onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  var check_sections = document.getElementsByClassName("webex-check");
  console.log("check:", check_sections.length);
  for (var i = 0; i < check_sections.length; i++) {
    check_sections[i].classList.add("unchecked");

    let btn = document.createElement("button");
    btn.innerHTML = "Show Answers";
    btn.classList.add("webex-check-button");
    btn.onclick = check_func;
    check_sections[i].appendChild(btn);

    let spn = document.createElement("span");
    spn.classList.add("webex-total_correct");
    check_sections[i].appendChild(spn);
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;

    solveme[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }

  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
    selects[i].insertAdjacentHTML("afterend", " <span class='webex-icon'></span>")
  }

  update_total_correct();
}

</script><!-- In this example, we illustrate how to use DAGs for causal inference, including the detection of a violation of the initial model and subsequent adaptation of the DAG. We could use that to illustrate updating FAIR theory: --><!-- https://currentprotocols.onlinelibrary.wiley.com/doi/full/10.1002/cpz1.45 --><!-- We can find more examples of causal inference with DAGs in these tutorials: --><!-- https://www.r-bloggers.com/2019/08/causal-inference-with-dags-in-r/ --><!-- https://www.r-bloggers.com/2018/08/applications-of-dags-in-causal-inference/ --><div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Directed acyclic graphs (DAGs) are a powerful tool for expressing and
testing causal assumptions. They allow researchers to identify potential
confounders or colliders, and guide decisions about which variables to
control for (or not) in statistical analyses <span class="citation">[@cinelliCrashCourseGood2022]</span>. DAGs can be
implemented as FAIR theories, or can be derived from FAIR theories. In
this vignette, we’ll illustrate how to use DAGs for causal inference in
<code>R</code>, inspired by the <em>Tripartite Model</em> of the impact
of the family on children’s emotion regulation and adjustment <span class="citation">[@morrisRoleFamilyContext2007]</span>.</p>
<div class="section level3">
<h3 id="learning-goals">Learning Goals<a class="anchor" aria-label="anchor" href="#learning-goals"></a>
</h3>
<p>Once you have completed this tutorial, you will know how to:</p>
<ul class="task-list">
<li><label><input type="checkbox">Implement a theory represented as a
diagram as a FAIR theory</label></li>
<li><label><input type="checkbox">Access that FAIR theory in the data
analysis environment (i.e., theory reuse)</label></li>
<li><label><input type="checkbox">Generate synthetic data from a FAIR
theory</label></li>
<li><label><input type="checkbox">Select control variables using a
FAIR theory</label></li>
<li><label><input type="checkbox">Perform basic causal inference based
on a FAIR theory</label></li>
</ul>
<!-- Below, we’ll translate this example into a simple DAG, simulate some data, and demonstrate how controlling for the collider can change the observed relationship between Immigrant Status and Self-Efficacy. -->
</div>
<div class="section level3">
<h3 id="optional-video-lecture">Optional: Video Lecture<a class="anchor" aria-label="anchor" href="#optional-video-lecture"></a>
</h3>
<p><a href="https://www.youtube.com/watch?v=wBB4sed9ku0" class="external-link">This video
lecture</a> gives an introduction to causal inference, with a focus on
DAGs comprising three variables, including the distinction between
confounders and colliders.</p>
<!-- <iframe width="560" height="315" src="http://www.youtube.com/embed/wBB4sed9ku0?rel=0" frameborder="0" allowfullscreen></iframe> -->
</div>
</div>
<div class="section level2">
<h2 id="install-and-load-required-packages">Install and Load Required Packages<a class="anchor" aria-label="anchor" href="#install-and-load-required-packages"></a>
</h2>
<p>We’ll use the following packages:</p>
<ul>
<li>
<code>theorytools</code> for functions pertaining to FAIR theory and
a sample dataset</li>
<li>
<code>dagitty</code> for interacting with Directed Acyclic Graphs
(DAGs)</li>
<li>
<code>tidySEM</code> for visualizing DAGs</li>
</ul>
<p>If you already have these packages installed, it is not necessary to
run this code:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"theorytools"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"dagitty"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"tidySEM"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/cjvanlissa/theorytools" class="external-link">theorytools</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.dagitty.net" class="external-link">dagitty</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://cjvanlissa.github.io/tidySEM/" class="external-link">tidySEM</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: OpenMx</span></span>
<span><span class="co">#&gt; Registered S3 method overwritten by 'tidySEM':</span></span>
<span><span class="co">#&gt;   method          from  </span></span>
<span><span class="co">#&gt;   predict.MxModel OpenMx</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'tidySEM'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:dagitty':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     edges</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="the-tripartite-model">The Tripartite Model<a class="anchor" aria-label="anchor" href="#the-tripartite-model"></a>
</h2>
<p>The tripartite model identifies three major familial influences on
children’s ER:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Observation (O)</strong>, e.g., modeling parents’
behavior</li>
<li>
<strong>Parenting practices (PP)</strong>, e.g., emotion
coaching</li>
<li>
<strong>Emotional Family Climate (EC)</strong>, e.g., attachment
style</li>
</ol>
<p>These three factors, together with <strong>parent characteristics
(PC)</strong> and <strong>child characteristics (CC)</strong>, shape the
child’s <strong>emotion regulation (ER)</strong>, which in turn
influences the child’s <strong>adjustment (A)</strong> (e.g.,
internalizing/externalizing problems, social competence).</p>
<p>The model is visually represented below:</p>
<div class="figure">
<img src="morris.png" alt="An interpretation of Morris' Tripartite Model of Emotion Regulation Development" width="70%"><p class="caption">
An interpretation of Morris’ Tripartite Model of Emotion Regulation
Development
</p>
</div>
<p>This figure, loosely based on the visual representation of the theory
in the paper by Morris and colleagues, is relatively formalized compared
to the standard for developmental psychological theories. Before we can
FAIRify this theory, however, we have to clarify a few things, and make
some decisions.</p>
<p>First, notice that the model does not explicitly follow any graphing
convention. It resembles a structural equation model - but notice that
there is an unconnected bold double-headed arrow near CC (Child
Characteristics). The written description of the text clarifies the
meaning of the bold arrow: the authors argue that Child Characteristics
<em>“moderate relations between family context [and] ER”</em> (Morris et
al., 2007, p. 364).</p>
<p>Second, note that most arrows are bidirectional. This would be fine
if we wished to specify the model as a structural equation model where
associations can be undirected. However, since our goal is to perform
causal inference, we need a <strong>directed</strong> acyclic graph.
This means we have to assume a direction of causality for all
bidirectional arrows. Reading the text helps us direct some arrows: we
read that <em>“children <strong>learn</strong> about ER through
[Observation]”</em>, <em>“parenting practices <strong>affect</strong>
ER”</em>, and <em>“ER <strong>is affected by</strong> the emotional
climate”</em>. This is all causal language <span class="citation">[@norouziCapturingCausalClaims2024]</span>. Even though
we later read that <em>“ER and familial influences are bidirectional
processes in our model”</em>, and even though some recent publications
have argued that child effects on parents outweigh parents’ effects on
children in emotional development <span class="citation">[@vanlissaMothersFathersQuantitative2020]</span>, for
the purpose of this tutorial, we will assume only parent effects on
children. It is fine to make strong assumptions when specifying theory;
if they are inconsistent with the data, we can revise them later.</p>
<p>Third, note that it is not clear if there is a path from Parenting
Practices to Adjustment. While there are paths from Observation and
Emotional Climate to Adjustment, we read in the text: <em>“although
there are direct effects of the family context on children’s adjustment
[…] a mediational model is proposed”</em>. Elsewhere in the text,
“family context” is defined in terms of all three predictors (O, PP, and
EC). We can thus either include all three direct effects, or omit them
and assume full mediation. Since the latter option results in a much
simpler DAG, we opt for full mediation.</p>
<div class="section level3">
<h3 id="implementing-the-tripartite-model-as-a-dag">Implementing the Tripartite Model as a DAG<a class="anchor" aria-label="anchor" href="#implementing-the-tripartite-model-as-a-dag"></a>
</h3>
<p>We can implement the model as a DAG using the <code>dagitty</code>
package. We start with an “ontology”, or simply, by stating which
constructs exist in our DAG:</p>
<pre><code>tripartite &lt;- dagitty('dag {
O
PP
EC
PC
CC
ER
A</code></pre>
<p>Next, we add the directed edges that were present in the original
theory:</p>
<pre><code><span><span class="va">PC</span> <span class="op">-&gt;</span> <span class="va">CC</span></span>
<span><span class="va">PC</span> <span class="op">-&gt;</span> <span class="va">EC</span></span>
<span><span class="va">PC</span> <span class="op">-&gt;</span> <span class="va">PP</span></span>
<span><span class="va">PC</span> <span class="op">-&gt;</span> <span class="va">O</span></span></code></pre>
<p>Next, we direct the edges that run from Observation, Parenting
Practices, and Emotional Climate to Emotion Regulation. We omit direct
effects to Adjustment, and include an effect from ER to Adjustment.</p>
<pre><code><span><span class="va">O</span> <span class="op">-&gt;</span> <span class="va">ER</span></span>
<span><span class="va">PP</span> <span class="op">-&gt;</span> <span class="va">ER</span></span>
<span><span class="va">EC</span> <span class="op">-&gt;</span> <span class="va">ER</span></span>
<span></span>
<span><span class="va">ER</span> <span class="op">-&gt;</span> <span class="va">A</span></span></code></pre>
<p>Next, we incorporate the effects of Child Characteristics. These are
moderation effects. In a DAG, the interaction effect of two predictors
on an outcome is simply represented by specifying both predictors as
common causes of the outcome. When specifying a model, however, we may
have to explicitly include interaction effects. We can annotate the
graph in such a way that it is clear which variables are involved in
interactions with O, PP, and EC, like this:</p>
<pre><code><span><span class="va">CC</span> <span class="op">-&gt;</span> <span class="va">ER</span> <span class="op">[</span>form<span class="op">=</span><span class="st">"CC:O+CC:PP+CC:EC"</span><span class="op">]</span>;</span></code></pre>
<p>Finally, we have to make a decision about the interrelations between
the predictors of emotion regulation. We could omit them, or delve
further into the literature to direct them. For now, I made the
following assumptions:</p>
<ul>
<li>The Emotional Climate and specific Parenting Practices affect
children’s Observation (=modeling) of parents’ behavior</li>
<li>Parenting Practices affect the Emotional Climate</li>
</ul>
<pre><code>PP -&gt; O
EC -&gt; O
PP -&gt; EC}')</code></pre>
<p>Now, we have a complete DAG!</p>
<div class="webex-check webex-box">
<span>
<p style="margin-top:1em; text-align:center">
<b>Quiz</b>
</p>
<p style="margin-left:1em;">
</p>
<p>A DAG can have arrows that run left to right, arrows that run right
to left, and bidirectional arrows.
<select class="webex-select"><option value="blank"></option>
<option value="">TRUE</option>
<option value="answer">FALSE</option></select></p>
<p>An interaction effect of X1 and X2 on Y is represented in a DAG by
drawing a directed arrow from X1 to Y, and from X2 to Y.
<select class="webex-select"><option value="blank"></option>
<option value="answer">TRUE</option>
<option value="">FALSE</option></select></p>
Information about functional form, like
<code>[form="CC:O+CC:PP+CC:EC"]</code>, is part of the DAG.
<select class="webex-select"><option value="blank"></option>
<option value="">TRUE</option>
<option value="answer">FALSE</option></select><p></p></span>
</div>
</div>
</div>
<div class="section level2">
<h2 id="from-dag-to-fair-theory">From DAG to FAIR Theory<a class="anchor" aria-label="anchor" href="#from-dag-to-fair-theory"></a>
</h2>
<p>A DAG is not yet a FAIR theory. We can FAIRify the DAG we specified
above by following the steps outlined in the <a href="https://cjvanlissa.github.io/theorytools/articles/fair-theory.html" class="external-link">Making
a Theory FAIR vignette</a>. We briefly go over the steps here. First,
let’s save the DAG to a text file:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="va">tripartite</span>, <span class="st">"tripartite_model.txt"</span><span class="op">)</span></span></code></pre></div>
<p>Your <a href="https://cjvanlissa.github.io/worcs/articles/setup.html" class="external-link">GitHub
integration must be set up</a> for the next step to work. You can check
if everything is set up correctly by running:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">worcs</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/worcs/man/check_worcs_installation.html" class="external-link">check_git</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">worcs</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/worcs/man/check_worcs_installation.html" class="external-link">check_github</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Next, we can create a FAIR theory repository:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/create_fair_theory.html">create_fair_theory</a></span><span class="op">(</span></span>
<span>  path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"c:/theories"</span>, <span class="st">"tripartite_model"</span><span class="op">)</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Tripartite Model"</span>,</span>
<span>  theory_file <span class="op">=</span> <span class="st">"tripartite_model.txt"</span>,</span>
<span>  remote_repo <span class="op">=</span> <span class="st">"tripartite_model"</span>,</span>
<span>  add_license <span class="op">=</span> <span class="st">"cc0"</span><span class="op">)</span></span></code></pre></div>
<p>Update the <code>README.md</code> file as necessary. Then, go to
Zenodo, and <a href="https://cjvanlissa.github.io/theorytools/articles/fair-theory.html#select-the-repository-to-archive" class="external-link">switch
on archiving for this GitHub repository</a>. Once this is done, run:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">worcs</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/worcs/man/git_remote_create.html" class="external-link">git_release_publish</a></span><span class="op">(</span>repo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">"c:/theories"</span>, <span class="st">"tripartite_model"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Finally, you can <a href="https://cjvanlissa.github.io/theorytools/articles/fair-theory.html#entering-meta-data" class="external-link">edit
the metadata</a> for the archived version on Zenodo.</p>
<p>The following DOI shows my version of the FAIR Tripartite Model: <a href="https://doi.org/10.5281/zenodo.14921521" class="external-link uri">https://doi.org/10.5281/zenodo.14921521</a></p>
</div>
<div class="section level2">
<h2 id="accessing-an-existing-fair-theory">Accessing an Existing FAIR Theory<a class="anchor" aria-label="anchor" href="#accessing-an-existing-fair-theory"></a>
</h2>
<p>There are several ways in which we can access an existing FAIR
theory. If our goal is simply to use it in our analysis workflow (as is
the case in this tutorial), then we can access the static archived
version on Zenodo by running:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/download_zenodo.html">download_zenodo</a></span><span class="op">(</span></span>
<span>  doi <span class="op">=</span> <span class="st">"https://doi.org/10.5281/zenodo.14921521"</span>,</span>
<span>  path <span class="op">=</span> <span class="st">"c:/theories/tripartite_downloaded"</span><span class="op">)</span></span></code></pre></div>
<p>If we want to contribute to further theory development, we might
instead prefer to <a href="https://github.com/github/docs/blob/main/content/pull-requests/collaborating-with-pull-requests/working-with-forks/fork-a-repo.md" class="external-link">fork
the original GitHub repository</a> to our own GitHub account, and create
a local clone of our newly forked repository. In R, you can clone a
repository like so:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gert</span><span class="fu">::</span><span class="fu"><a href="https://docs.ropensci.org/gert/reference/git_fetch.html" class="external-link">git_clone</a></span><span class="op">(</span></span>
<span>  url <span class="op">=</span> <span class="st">"https://github.com/cjvanlissa/tripartite_model.git"</span>,</span>
<span>  path <span class="op">=</span> <span class="st">"c:/theories/tripartite_clone"</span><span class="op">)</span></span></code></pre></div>
<p>The difference between these two approaches is that the former only
copies the statically archived files to your device, whereas the latter
copies the entire Git repository with its history of commits and all
branches, and continues to version control changes you make.</p>
<p>For this tutorial, please download my version of the Tripartite Model
using <code><a href="../reference/download_zenodo.html">download_zenodo()</a></code>.</p>
</div>
<div class="section level2">
<h2 id="x-interoperability-in-r">X-Interoperability in R<a class="anchor" aria-label="anchor" href="#x-interoperability-in-r"></a>
</h2>
<p>Interoperability pertains to the ability to use a theory in
scientific workflows. X-interoperability refers to the ability to use a
theory for <em>specific operations</em> in scientific workflows. When we
go through the remainder of the turorial, we are demonstrating that our
FAIR tripartite model is X-interoperable for visualization in R, for
selecting control variables, for performing causal inference, et cetera.
That is to say: we can directly ingest the FAIR theory in R, and
interact with it in our analysis environment and use it to construct
fully reproducible analysis workflows, including for causal
inference.</p>
<p>First, let’s ingest the theory into our R environment:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tripartite</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dagitty/man/dagitty.html" class="external-link">dagitty</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="st">"c:/theories/tripartite_downloaded/tripartite_model.txt"</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Then, we can plot the model using the <code>tidySEM</code>
package:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://cjvanlissa.github.io/tidySEM/reference/graph_sem.html" class="external-link">graph_sem</a></span><span class="op">(</span><span class="va">tripartite</span><span class="op">)</span></span></code></pre></div>
<p><img src="causal-inference_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>We can optionally specify a layout for the graph, so that it
resembles the model as visualized by Morris and colleagues:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://cjvanlissa.github.io/tidySEM/reference/get_layout.html" class="external-link">get_layout</a></span><span class="op">(</span></span>
<span>  <span class="st">""</span>,   <span class="st">"O"</span>,  <span class="st">""</span>,   <span class="st">""</span>, <span class="st">""</span>,</span>
<span>  <span class="st">""</span>,   <span class="st">"PP"</span>, <span class="st">""</span>,   <span class="st">"ER"</span>,   <span class="st">"A"</span>,</span>
<span>  <span class="st">""</span>,   <span class="st">"EC"</span>, <span class="st">""</span>,   <span class="st">""</span>,   <span class="st">""</span>,</span>
<span>  <span class="st">"PC"</span>, <span class="st">""</span>,   <span class="st">"CC"</span>, <span class="st">""</span>,   <span class="st">""</span>,</span>
<span>  rows <span class="op">=</span> <span class="fl">4</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://cjvanlissa.github.io/tidySEM/reference/graph_sem.html" class="external-link">graph_sem</a></span><span class="op">(</span><span class="va">tripartite</span>, layout <span class="op">=</span> <span class="va">lo</span><span class="op">)</span></span></code></pre></div>
<p><img src="causal-inference_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<p>The tidySEM vignette on <a href="https://cjvanlissa.github.io/tidySEM/articles/Plotting_graphs.html" class="external-link">plotting
structural equation models</a> further explains how to customize this
figure, which is a <code>ggplot</code> object.</p>
<div class="webex-check webex-box">
<span>
<p style="margin-top:1em; text-align:center">
<b>Quiz</b>
</p>
<p style="margin-left:1em;">
</p>
<p>Which of the following describes the property of X-interoperability
of a FAIR theory?
<select class="webex-select"><option value="blank"></option>
<option value="NA">It
can be reused for any operation.</option>
<option value="NA">It is
licenced to be reused.</option>
<option value="answer">It can be reused
for a specific operation.</option>
<option value="NA">It can be reused by
any person.</option></select></p>
If you are contributing to theory development, which platform provides
infrastructure to coordinate collaborate with known others and
strangers?
<select class="webex-select"><option value="blank"></option>
<option value="NA">RStudio</option>
<option value="answer">GitHub</option>
<option value="NA">Zenodo</option></select><p></p></span>
</div>
</div>
<div class="section level2">
<h2 id="simulating-data-from-the-fair-theory">Simulating Data from the FAIR Theory<a class="anchor" aria-label="anchor" href="#simulating-data-from-the-fair-theory"></a>
</h2>
<p>Simulation studies allow us to explore the implications of model
assumptions, to plan our analyses before data collection, to conduct
power analysis and plan our sample size, and to preregister a fully
reproducible analysis pipeline <span class="citation">[Preregistration-As-Code,
@peikertReproducibleResearchTutorial2021;
@vanlissaComplementingPreregisteredConfirmatory2022]</span>.</p>
<p>Below is a simplistic code snippet to generate synthetic data using
the <code><a href="https://rdrr.io/pkg/dagitty/man/simulateSEM.html" class="external-link">dagitty::simulateSEM()</a></code> function. This function
interprets the DAG as a structural equation model, samples random values
for the path coefficients (unless specific values are provided), and
assumes normal residual variances. Note that many other functions for
simulating data exist, and some may be better suited to particular use
cases.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">df_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dagitty/man/simulateSEM.html" class="external-link">simulateSEM</a></span><span class="op">(</span><span class="va">tripartite</span>, N <span class="op">=</span> <span class="fl">497</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df_sim</span><span class="op">)</span></span>
<span><span class="co">#&gt;             A         CC           EC         ER          O          PC</span></span>
<span><span class="co">#&gt; 1  0.04103747 -0.6521996  0.441980426  1.3464706 -1.1814515  0.83889824</span></span>
<span><span class="co">#&gt; 2  1.88702074 -0.1975775 -0.256197190  1.0674489  0.3406396 -0.02163595</span></span>
<span><span class="co">#&gt; 3  0.40705740 -1.3591083  0.319985214  1.1334489  1.8517664 -1.06364141</span></span>
<span><span class="co">#&gt; 4 -0.51613591  0.7973387 -0.337020725 -1.1480291 -1.5748778  0.37919677</span></span>
<span><span class="co">#&gt; 5  1.22537069 -1.5630894 -1.946047994  0.5514646 -0.6099942  0.01637417</span></span>
<span><span class="co">#&gt; 6 -1.23368280 -0.9879830  0.009866581  0.8895392  0.8006259 -1.26121894</span></span>
<span><span class="co">#&gt;           PP</span></span>
<span><span class="co">#&gt; 1  0.1457759</span></span>
<span><span class="co">#&gt; 2 -0.6250181</span></span>
<span><span class="co">#&gt; 3 -0.4471091</span></span>
<span><span class="co">#&gt; 4  0.4668580</span></span>
<span><span class="co">#&gt; 5  0.1474225</span></span>
<span><span class="co">#&gt; 6 -1.1976349</span></span></code></pre></div>
<p>This synthetic dataset is consistent with the structure encoded in
our Tripartite Model, though the parameter values are arbitrary. In real
research, you might use prior studies or expert knowledge to set more
realistic parameter values. For this tutorial, we select some ad-hoc
values, and assign zero (0), small (.2), or medium (.4) effect sizes to
the paths in our DAG:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tripartite_coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dagitty/man/dagitty.html" class="external-link">dagitty</a></span><span class="op">(</span><span class="st">'dag {</span></span>
<span><span class="st">O</span></span>
<span><span class="st">PP</span></span>
<span><span class="st">EC</span></span>
<span><span class="st">PC</span></span>
<span><span class="st">CC</span></span>
<span><span class="st">ER</span></span>
<span><span class="st">A</span></span>
<span><span class="st"></span></span>
<span><span class="st">PC -&gt; CC [beta=.4]</span></span>
<span><span class="st">PC -&gt; EC [beta=.2]</span></span>
<span><span class="st">PC -&gt; PP [beta=.2]</span></span>
<span><span class="st">PC -&gt; O [beta=0]</span></span>
<span><span class="st"></span></span>
<span><span class="st">O -&gt; ER [beta=.2]</span></span>
<span><span class="st">PP -&gt; ER [beta=0]</span></span>
<span><span class="st">EC -&gt; ER [beta=.2]</span></span>
<span><span class="st"></span></span>
<span><span class="st">ER -&gt; A [beta=.4]</span></span>
<span><span class="st"></span></span>
<span><span class="st">CC -&gt; ER [beta=.4];</span></span>
<span><span class="st"></span></span>
<span><span class="st">PP -&gt; O [beta=0]</span></span>
<span><span class="st">EC -&gt; O [beta=0]</span></span>
<span><span class="st">PP -&gt; EC  [beta=.2]</span></span>
<span><span class="st">}'</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">51</span><span class="op">)</span></span>
<span><span class="va">df_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dagitty/man/simulateSEM.html" class="external-link">simulateSEM</a></span><span class="op">(</span><span class="va">tripartite_coef</span>, N <span class="op">=</span> <span class="fl">497</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="selecting-control-variables">Selecting Control Variables<a class="anchor" aria-label="anchor" href="#selecting-control-variables"></a>
</h2>
<p>One advantage of a DAG is the ability to identify <strong>which
variables should be controlled for</strong> (e.g., to avoid confounding)
and which variables should <strong>not</strong> be controlled for (e.g.,
colliders). In <code>dagitty</code>, you can use the function
<code><a href="https://rdrr.io/pkg/dagitty/man/adjustmentSets.html" class="external-link">adjustmentSets()</a></code> to find minimal sufficient adjustment sets
for estimating specific causal effects.</p>
<p>For instance, let’s say we want to examine the causal effect of
Observation on Emotion Regulation. We can run:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/dagitty/man/adjustmentSets.html" class="external-link">adjustmentSets</a></span><span class="op">(</span><span class="va">tripartite</span>, exposure<span class="op">=</span><span class="st">"O"</span>, outcome<span class="op">=</span><span class="st">"ER"</span><span class="op">)</span></span>
<span><span class="co">#&gt; { CC, EC, PP }</span></span>
<span><span class="co">#&gt; { EC, PC, PP }</span></span></code></pre></div>
<p>The DAG-based algorithm identifies which sets of variables are
sufficient to block backdoor paths, given some strong assumptions <span class="citation">[@pearlCausalDiagramsEmpirical1995]</span>. The result
suggests that it is enough to control for Child Characteristics,
Emotional Climate, and Parenting Practices if we wish to obtain an
unbiased estimate of the effect of Observation on Emotion Regulation.
Alternatively, we can control for Parent Characteristics, Emotional
Climate, and Parenting Practices.</p>
<div class="webex-check webex-box">
<span>
<p style="margin-top:1em; text-align:center">
<b>Quiz</b>
</p>
<p style="margin-left:1em;">
</p>
<p>When estimating the effect of Observation on Emotion Regulation, It
is fine to control for both Child Characteristics and Parent
Characteristics.
<select class="webex-select"><option value="blank"></option>
<option value="">TRUE</option>
<option value="answer">FALSE</option></select></p>
What is the smallest possible simple adjustment set for the effect of
Child Characteristics on Adjustment?
<select class="webex-select"><option value="blank"></option>
<option value="">EC,
PC, PP</option>
<option value="">EC, O,
PP</option>
<option value="answer">PC</option></select><p></p></span>
</div>
</div>
<div class="section level2">
<h2 id="basic-causal-inference">Basic Causal Inference<a class="anchor" aria-label="anchor" href="#basic-causal-inference"></a>
</h2>
<p>Once we know which variables to control for, we can use standard
regression to estimate the causal effect. Using regression assumes that
all causal effects are linear and additive, with normally distributed
residuals and predictors without measurement error. Other methods exist
which do not make these assumptions. We can use the function
<code><a href="../reference/select_controls.html">select_controls()</a></code> to construct a <code>data.frame</code>
with our exposure, outcome, and the relevant control variables. This
facilitates conducting causal inference with the appropriate control
variables, as you can just use the model formula
<code>outcome ~ exposure</code> to obtain the uncontrolled effect, and
<code>outcome ~ .</code> to obtain the causal estimate.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_controls</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/select_controls.html">select_controls</a></span><span class="op">(</span><span class="va">tripartite</span>, <span class="va">df_sim</span>, exposure <span class="op">=</span> <span class="st">"O"</span>, outcome <span class="op">=</span> <span class="st">"ER"</span><span class="op">)</span></span>
<span><span class="va">model_bivariate</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">ER</span> <span class="op">~</span> <span class="va">O</span>, <span class="va">df_controls</span><span class="op">)</span></span>
<span><span class="va">model_causal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">ER</span> <span class="op">~</span><span class="va">.</span>, <span class="va">df_controls</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_bivariate</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = ER ~ O, data = df_controls)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -2.8773 -0.6705 -0.0366  0.7262  3.2154 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)</span></span>
<span><span class="co">#&gt; (Intercept) -0.02616    0.04608  -0.568    0.571</span></span>
<span><span class="co">#&gt; O            0.06788    0.04652   1.459    0.145</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 1.023 on 495 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.004283,   Adjusted R-squared:  0.002271 </span></span>
<span><span class="co">#&gt; F-statistic: 2.129 on 1 and 495 DF,  p-value: 0.1452</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model_causal</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = ER ~ ., data = df_controls)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -2.5732 -0.5483  0.0839  0.6073  3.4954 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept) -0.03514    0.04053  -0.867  0.38633    </span></span>
<span><span class="co">#&gt; O            0.13537    0.04140   3.270  0.00115 ** </span></span>
<span><span class="co">#&gt; CC           0.46224    0.04085  11.315  &lt; 2e-16 ***</span></span>
<span><span class="co">#&gt; EC           0.19545    0.03996   4.891 1.36e-06 ***</span></span>
<span><span class="co">#&gt; PP          -0.04527    0.04082  -1.109  0.26793    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 0.8965 on 492 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.2397, Adjusted R-squared:  0.2335 </span></span>
<span><span class="co">#&gt; F-statistic: 38.78 on 4 and 492 DF,  p-value: &lt; 2.2e-16</span></span></code></pre></div>
<div class="webex-check webex-box">
<span>
<p style="margin-top:1em; text-align:center">
<b>Quiz</b>
</p>
<p style="margin-left:1em;">
</p>
<p>What is the causal effect of Observation on Emotion Regulation?
<input class="webex-solveme nospaces" data-tol="0.01" size="4" data-answer='["0.14",".14"]'></p>
<p>There is a significant causal effect of Observation on Emotion
Regulation.
<select class="webex-select"><option value="blank"></option>
<option value="answer">TRUE</option>
<option value="">FALSE</option></select></p>
If the DAG is correct, then <code>model_bivariate</code> gives us an
unbiased estimate of the effect of Observation on Emotion Regulation.
<select class="webex-select"><option value="blank"></option>
<option value="">TRUE</option>
<option value="answer">FALSE</option></select><p></p></span>
</div>
</div>
<div class="section level2">
<h2 id="using-real-data">Using Real Data<a class="anchor" aria-label="anchor" href="#using-real-data"></a>
</h2>
<p>When working with real data, causal inference quickly becomes more
complicated. Therefore, we provide a “real data” example here, to
practice the relevant skills. The <code>theorytools</code> package
includes a dataset that is based on <a href="https://aifs.gov.au/growing-up-in-australia" class="external-link">“Growing Up in
Australia - the Longitudinal Study of Australian Children” (LSAC)</a>.
As the LSAC dataset is accessible by explicit permission only, this is a
synthetic dataset with similar properties to the real data. Let’s access
the data:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">lsac</span><span class="op">)</span></span>
<span><span class="co">#&gt;     warmth relationship_quality temperament_negreact emotion_regulation</span></span>
<span><span class="co">#&gt; 1 3.500000             2.285714                 1.75                2.4</span></span>
<span><span class="co">#&gt; 2 5.000000             3.285714                 1.75                1.0</span></span>
<span><span class="co">#&gt; 3 5.000000             3.857143                 2.00                2.0</span></span>
<span><span class="co">#&gt; 4 3.333333             3.285714                 1.75                1.0</span></span>
<span><span class="co">#&gt; 5 4.333333             2.857143                 2.25                1.8</span></span>
<span><span class="co">#&gt; 6 2.833333                  NaN                 5.00                1.4</span></span>
<span><span class="co">#&gt;   social_functioning coping</span></span>
<span><span class="co">#&gt; 1                3.0      2</span></span>
<span><span class="co">#&gt; 2                1.6      3</span></span>
<span><span class="co">#&gt; 3                1.8      5</span></span>
<span><span class="co">#&gt; 4                1.2      3</span></span>
<span><span class="co">#&gt; 5                1.2      4</span></span>
<span><span class="co">#&gt; 6                2.6      1</span></span></code></pre></div>
<div class="section level3">
<h3 id="mapping-measured-variables-onto-theoretical-constructs">Mapping Measured Variables onto Theoretical Constructs<a class="anchor" aria-label="anchor" href="#mapping-measured-variables-onto-theoretical-constructs"></a>
</h3>
<p>Here, we are using real data to operationalize the theoretical
constructs in our DAG. If we inspect the documentation of the data, we
can conclude that the most likely mapping of constructs to variables
is:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">operationalizations</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>PP <span class="op">=</span> <span class="st">"warmth"</span>, EC <span class="op">=</span> <span class="st">"relationship_quality"</span>, CC <span class="op">=</span> <span class="st">"temperament_negreact"</span>, ER <span class="op">=</span> <span class="st">"emotion_regulation"</span>, A <span class="op">=</span> <span class="st">"social_functioning"</span>, PC <span class="op">=</span> <span class="st">"coping"</span><span class="op">)</span></span></code></pre></div>
<p>Let’s rename the variables, so the data and the DAG are consistent.
We will also perform a rudimentary imputation, as missing data can cause
problems later on. Note that there is abundant literature on best
practices in handling missing data; here, we use single imputation for
pragmatic reasons.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Impute missing data</span></span>
<span><span class="va">df_real</span> <span class="op">&lt;-</span> <span class="fu">VIM</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/VIM/man/kNN.html" class="external-link">kNN</a></span><span class="op">(</span><span class="va">lsac</span>, numFun <span class="op">=</span> <span class="va">median</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_real</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">operationalizations</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="va">operationalizations</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">df_real</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>Note that one variable is missing: Observation (O). This is
unfortunate, as for the previous example we used O as our exposure
variable. For the remainder of the examples, we will use Parenting
Practices as our exposure variable. Obtain the adjusment set for the
effect of Parenting Practices on Emotion Regulation:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/dagitty/man/adjustmentSets.html" class="external-link">adjustmentSets</a></span><span class="op">(</span><span class="va">tripartite</span>, exposure <span class="op">=</span> <span class="st">"EC"</span>, outcome <span class="op">=</span> <span class="st">"ER"</span><span class="op">)</span></span>
<span><span class="co">#&gt; { PC, PP }</span></span></code></pre></div>
<p>Any DAG implies conditional independencies: variables that should be
statistically independent from one another, after controlling for a
specific adjustment set. As a kind of assumption check, we could test if
the variables in our dataset indeed show these statistical
independencies. If our data show dependencies where the DAG implies
independence, this can be taken as evidence against the veracity of our
DAG. Of course, there are alternative explanations: how we
operationalized the construct, the presence of measurement error,
sampling bias, et cetera.</p>
<p>The function <code>localTests</code> applies the d-separation
criterion to determine all conditional independencies implied by a DAG,
and then performs tests for each of them. Different types of tests are
available for different types of variables. For continuous variables
(which we have), the <code>"cis.loess"</code> method provides
non-parametric conditional independence tests using bootstrapped loess
regression.</p>
<p>Let’s first conduct conditional independence tests for the dataset
that we simulated from the DAG. Because we’re conducting a lot of
significance tests, we can control the overall probability of making a
Type I error (i.e., drawing false positive conclusions about
discrepancies between DAG and data). We can use Bonferroni-corrected
bootstrapped confidence intervals for testing, as demonstrated in the
following code block:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get all DAG-implied conditional independencies</span></span>
<span><span class="va">cis</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dagitty/man/impliedConditionalIndependencies.html" class="external-link">impliedConditionalIndependencies</a></span><span class="op">(</span><span class="va">tripartite</span><span class="op">)</span></span>
<span><span class="co"># Bonferroni-corrected confidence interval</span></span>
<span><span class="va">bonferroni</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">-</span><span class="op">(</span><span class="fl">.05</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cis</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Conduct the tests</span></span>
<span><span class="va">ci_tests</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dagitty/man/localTests.html" class="external-link">localTests</a></span><span class="op">(</span><span class="va">tripartite</span>, <span class="va">df_sim</span>, type <span class="op">=</span> <span class="st">"cis.loess"</span>, R <span class="op">=</span> <span class="fl">1000</span>, tests <span class="op">=</span> <span class="va">cis</span>, conf.level <span class="op">=</span> <span class="va">bonferroni</span><span class="op">)</span></span>
<span><span class="co"># Print result, with added significance asterisks</span></span>
<span><span class="fu"><a href="../reference/add_significance.html">add_significance</a></span><span class="op">(</span><span class="va">ci_tests</span><span class="op">)</span></span>
<span><span class="co">#&gt;                               estimate  std.error       0.25%      99.75%</span></span>
<span><span class="co">#&gt; A _||_ CC | ER             -0.02488395 0.04541527 -0.14715226 0.108502878</span></span>
<span><span class="co">#&gt; A _||_ EC | ER             -0.08206144 0.04910397 -0.20560400 0.055630567</span></span>
<span><span class="co">#&gt; A _||_ O | ER               0.01604344 0.04103371 -0.09277371 0.135921735</span></span>
<span><span class="co">#&gt; A _||_ PC | CC, EC, O, PP  -0.06710313 0.04162413 -0.18500210 0.033920284</span></span>
<span><span class="co">#&gt; A _||_ PC | ER             -0.06037961 0.04378464 -0.17342936 0.056272447</span></span>
<span><span class="co">#&gt; A _||_ PP | ER             -0.01504872 0.04463377 -0.13707558 0.109638952</span></span>
<span><span class="co">#&gt; CC _||_ EC | PC            -0.06701484 0.04548868 -0.18696604 0.058277531</span></span>
<span><span class="co">#&gt; CC _||_ O | PC             -0.04608873 0.04135799 -0.15492342 0.067892851</span></span>
<span><span class="co">#&gt; CC _||_ PP | PC             0.03402876 0.04614528 -0.09232252 0.161732327</span></span>
<span><span class="co">#&gt; ER _||_ PC | CC, EC, O, PP -0.11134996 0.04751354 -0.23923411 0.009837374</span></span>
<span><span class="co">#&gt;                            significant</span></span>
<span><span class="co">#&gt; A _||_ CC | ER                        </span></span>
<span><span class="co">#&gt; A _||_ EC | ER                        </span></span>
<span><span class="co">#&gt; A _||_ O | ER                         </span></span>
<span><span class="co">#&gt; A _||_ PC | CC, EC, O, PP             </span></span>
<span><span class="co">#&gt; A _||_ PC | ER                        </span></span>
<span><span class="co">#&gt; A _||_ PP | ER                        </span></span>
<span><span class="co">#&gt; CC _||_ EC | PC                       </span></span>
<span><span class="co">#&gt; CC _||_ O | PC                        </span></span>
<span><span class="co">#&gt; CC _||_ PP | PC                       </span></span>
<span><span class="co">#&gt; ER _||_ PC | CC, EC, O, PP</span></span></code></pre></div>
<p>Now, let’s perform the same tests for the real data. Because we have
a missing variable, we cannot test the complete set. We can filter all
conditional independencies that cannot be tested. Don’t forget to use a
different Bonferroni correction for the resulting (smaller number of)
tests!</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cis_real</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_conditional_independencies.html">filter_conditional_independencies</a></span><span class="op">(</span><span class="va">cis</span>, <span class="va">df_real</span><span class="op">)</span></span>
<span><span class="va">bonferroni</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">-</span><span class="op">(</span><span class="fl">.05</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">cis_real</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Conduct the tests</span></span>
<span><span class="va">ci_tests</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dagitty/man/localTests.html" class="external-link">localTests</a></span><span class="op">(</span><span class="va">tripartite</span>, <span class="va">df_real</span>, type <span class="op">=</span> <span class="st">"cis.loess"</span>, R <span class="op">=</span> <span class="fl">1000</span>, tests <span class="op">=</span> <span class="va">cis_real</span>, conf.level <span class="op">=</span> <span class="va">bonferroni</span><span class="op">)</span></span>
<span><span class="co"># Print result, with added significance asterisks</span></span>
<span><span class="fu"><a href="../reference/add_significance.html">add_significance</a></span><span class="op">(</span><span class="va">ci_tests</span><span class="op">)</span></span>
<span><span class="co">#&gt;                    estimate  std.error 0.416666666666665% 99.5833333333333%</span></span>
<span><span class="co">#&gt; A _||_ CC | ER   0.33415818 0.01156398          0.3050274        0.36573861</span></span>
<span><span class="co">#&gt; A _||_ EC | ER  -0.07461219 0.01175213         -0.1048497       -0.04367367</span></span>
<span><span class="co">#&gt; A _||_ PC | ER  -0.18556313 0.01142589         -0.2152855       -0.15789145</span></span>
<span><span class="co">#&gt; A _||_ PP | ER  -0.11868779 0.01128070         -0.1465077       -0.09036928</span></span>
<span><span class="co">#&gt; CC _||_ EC | PC -0.07078118 0.01182194         -0.1023458       -0.03836728</span></span>
<span><span class="co">#&gt; CC _||_ PP | PC -0.19258437 0.01229991         -0.2222188       -0.15670884</span></span>
<span><span class="co">#&gt;                 significant</span></span>
<span><span class="co">#&gt; A _||_ CC | ER            *</span></span>
<span><span class="co">#&gt; A _||_ EC | ER            *</span></span>
<span><span class="co">#&gt; A _||_ PC | ER            *</span></span>
<span><span class="co">#&gt; A _||_ PP | ER            *</span></span>
<span><span class="co">#&gt; CC _||_ EC | PC           *</span></span>
<span><span class="co">#&gt; CC _||_ PP | PC           *</span></span></code></pre></div>
<div class="webex-check webex-box">
<span>
<p style="margin-top:1em; text-align:center">
<b>Quiz</b>
</p>
<p style="margin-left:1em;">
</p>
<p>We can use Parenting Practices because O is not in its adjustment
set.
<select class="webex-select"><option value="blank"></option>
<option value="answer">TRUE</option>
<option value="">FALSE</option></select></p>
<p>Which of these causal effects can we estimate using these data?
<select class="webex-select"><option value="blank"></option>
<option value="NA">CC
-&gt; A</option>
<option value="NA">ER -&gt;
PC</option>
<option value="NA">PP -&gt;
A</option>
<option value="answer">All of these </option></select></p>
<p>The <code>ci_tests</code> give us reasons to doubt that
<code>df_sim</code> is consistent with the DAG.
<select class="webex-select"><option value="blank"></option>
<option value="">TRUE</option>
<option value="answer">FALSE</option></select></p>
<p>The <code>ci_tests</code> give us reasons to doubt that
<code>df_real</code> is consistent with the DAG.
<select class="webex-select"><option value="blank"></option>
<option value="answer">TRUE</option>
<option value="">FALSE</option></select></p>
Consider the sample size of <code>df_real</code>. Could this be related
to your answers in the previous two questions?
<select class="webex-select"><option value="blank"></option>
<option value="NA">No</option>
<option value="answer">Yes</option></select><p></p></span>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Caspar J. Van Lissa.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
